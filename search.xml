<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Jmeter踩坑：Beanshell断言判断响应是否为JSON格式]]></title>
    <url>%2F2019%2F03%2F10%2FJmeter%E8%B8%A9%E5%9D%91%EF%BC%9ABeanshell%E6%96%AD%E8%A8%80%E5%88%A4%E6%96%AD%E5%93%8D%E5%BA%94%E6%98%AF%E5%90%A6%E4%B8%BAJSON%E6%A0%BC%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[接口测试初期，先确认接口能否跑通，响应状态码为200，以及响应信息是json格式。Jmeter4.0之后新增了JSON Assertion，可以验证响应是不是json格式。但需同时验证响应状态码是否为200以及响应信息是否为json格式，可使用Jmeter工具添加beanshell断言。 下载json.jar，在测试计划中导入jar包 beanshell断言代码如下，可直接复制粘贴： 12345678910111213141516171819202122import org.json.*;//引入jar包String result = prev.getResponseDataAsString();//获取响应信息code=prev.getResponseCode();//获取响应状态码log.info(code);//打印状态码if(!code.equals(&quot;200&quot;))&#123; log.info(&quot;********状态码炸了********&quot;); Failure = true;//断言失败&#125; Object json = new JSONTokener(result).nextValue();//会给出一个对象，然后可以动态的转换为适当的类型if(json instanceof JSONObject)&#123;//判断其左边对象是否为其右边类的实例，返回boolean类型的数据 log.info(&quot;***是一个jsonObject***&quot;); Failure = false;//断言成功&#125;else if (json instanceof JSONArray)&#123; log.info(&quot;***是一个jsonArray***&quot;); Failure = false;//断言成功 &#125;else&#123; log.error(&quot;************不是一个json*************&quot;); Failure = true;//断言失败 &#125; 踩坑：最开始只想到了JSONObject，于是一片报红，后来发现有的响应是JSONArray，添加了对JSON数组的判断]]></content>
      <categories>
        <category>Jmeter</category>
      </categories>
  </entry>
</search>
